<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Goban.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;JeuDeGo&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">plateau</a> &gt; <span class="el_source">Goban.java</span></div><h1>Goban.java</h1><pre class="source lang-java linenums">/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package plateau;

import affichage.AffichageConsole;
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;

/**
 * Classe décrivant le goban.
 * @author Fabien
 */
public class Goban {
    private int taille;
    private Case[][] cases;
    private List&lt;Groupe&gt; groupes;
    private Joueur player1;
    private Joueur player2;
    private int passe;
    
<span class="fc" id="L25">    public Goban(int taille){</span>
<span class="fc" id="L26">        this.taille=taille;</span>
<span class="fc" id="L27">        passe = 0;</span>
<span class="fc" id="L28">        cases = new Case[taille][taille];</span>
<span class="fc bfc" id="L29" title="All 2 branches covered.">        for (int i=0; i&lt;taille; i++){</span>
<span class="fc bfc" id="L30" title="All 2 branches covered.">            for (int j=0; j&lt;taille; j++){</span>
<span class="fc" id="L31">                cases[i][j]=new Case(i,j,this);</span>
            }
        }
<span class="fc" id="L34">        this.player1 = new Joueur(Couleur.Noir, this);</span>
<span class="fc" id="L35">        this.player2 = new Joueur(Couleur.Blanc, this);</span>
<span class="fc" id="L36">        groupes = new LinkedList&lt;&gt;();</span>
<span class="fc" id="L37">    }</span>
    /**
     * Permet de changer la case en position i,j sur le goban
     * @param i abscisse de la case
     * @param j ordonnée de la case
     * @param p la nouvelle case
     */
    public void setCase(int i, int j, Case p){
<span class="nc" id="L45">        this.cases[i][j]=p;</span>
<span class="nc" id="L46">    }</span>
    /**
     * Méthode retournant la taille du goban
     * @return int : taille
     */
    public int getTaille() {
<span class="nc" id="L52">        return taille;</span>
    }

    public Joueur getPlayer1() {
<span class="fc" id="L56">        return player1;</span>
    }

    public Joueur getPlayer2() {
<span class="fc" id="L60">        return player2;</span>
    }
    
    /**
     * Méthode retournant la case située en i, j sur le plateau
     * @param i : abscisse de la case
     * @param j : ordonnée de la case
     * @return la Case en question
     */
    public Case getCase(int i, int j){
<span class="fc" id="L70">        Case c = null;</span>
<span class="pc bpc" id="L71" title="4 of 8 branches missed.">        if (i&gt;=0 &amp;&amp; j&gt;=0 &amp;&amp; i&lt;taille &amp;&amp; j&lt;taille){</span>
<span class="fc" id="L72">            c = cases[i][j];</span>
        }
<span class="fc" id="L74">        return c;</span>
    }
    
    
    public boolean horsPlateau(int a, int b){
<span class="fc bfc" id="L79" title="All 8 branches covered.">        return !(a&gt;=0 &amp;&amp; a&lt;taille &amp;&amp; b&gt;=0 &amp;&amp; b&lt;taille);</span>
    }
    
    public ArrayList&lt;Case&gt; getCasesAutourDe(Case pos){
<span class="fc" id="L83">        ArrayList&lt;Case&gt; a= new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L84" title="All 2 branches covered.">        if(!horsPlateau(pos.getX()-1, pos.getY())){</span>
<span class="fc" id="L85">            a.add(cases[pos.getX()-1][pos.getY()]);</span>
        }
<span class="fc bfc" id="L87" title="All 2 branches covered.">        if(!horsPlateau(pos.getX()+1, pos.getY())){</span>
<span class="fc" id="L88">            a.add(cases[pos.getX()+1][pos.getY()]);</span>
        }
<span class="fc bfc" id="L90" title="All 2 branches covered.">        if(!horsPlateau(pos.getX(), pos.getY()+1)){</span>
<span class="fc" id="L91">            a.add(cases[pos.getX()][pos.getY()+1]);</span>
        }
<span class="fc bfc" id="L93" title="All 2 branches covered.">        if(!horsPlateau(pos.getX(), pos.getY()-1)){</span>
<span class="fc" id="L94">            a.add(cases[pos.getX()][pos.getY()-1]);</span>
        }
<span class="fc" id="L96">        return a;</span>
    }

    public List&lt;Groupe&gt; getGroupes() {
<span class="fc" id="L100">        return groupes;</span>
    }
    
    public boolean isDansGroupe(Case c){
<span class="nc bnc" id="L104" title="All 2 branches missed.">        for (Groupe g : groupes){</span>
<span class="nc bnc" id="L105" title="All 2 branches missed.">            if (g.getPierres().contains(c)){</span>
<span class="nc" id="L106">                return true;</span>
            }
<span class="nc" id="L108">        }</span>
<span class="nc" id="L109">        return false;</span>
    }
    
    public void retirerGroupe(Groupe g){
<span class="fc" id="L113">        groupes.remove(g);</span>
<span class="fc" id="L114">    }</span>
    
    public void addGroupe(Case p){
<span class="fc" id="L117">        Groupe g = new Groupe(this);</span>
<span class="fc" id="L118">        g.addPierre(p);</span>
<span class="fc" id="L119">        groupes.add(g);</span>
<span class="fc" id="L120">    }</span>
    
    public void tourDeJeu(){
<span class="nc" id="L123">        AffichageConsole aff = new AffichageConsole(this);</span>
<span class="nc" id="L124">        aff.affichePlateau();</span>
<span class="nc" id="L125">        int compteur = 0;</span>
        do{
<span class="nc bnc" id="L127" title="All 2 branches missed.">            if (compteur == 0){</span>
<span class="nc" id="L128">                player1.jouer();</span>
<span class="nc" id="L129">                compteur++;</span>
            } else {
<span class="nc" id="L131">                player2.jouer();</span>
<span class="nc" id="L132">                compteur--;</span>
            }
<span class="nc" id="L134">            aff.affichePlateau();</span>
<span class="nc bnc" id="L135" title="All 2 branches missed.">        }while (passe &lt; 2);</span>
<span class="nc" id="L136">    }</span>
    
    public boolean isSuicide(Case pos, Joueur j){
<span class="nc" id="L139">        Groupe g  = new Groupe(this);</span>
<span class="nc" id="L140">        g.addPierre(pos);</span>
<span class="nc bnc" id="L141" title="All 2 branches missed.">        for(Groupe g1 : pos.getGroupesAdjacents()){</span>
<span class="nc bnc" id="L142" title="All 2 branches missed.">            if(g1.getPierres().get(0).getJoueur().equals(j)){</span>
<span class="nc" id="L143">                g.getPierres().addAll(g1.getPierres());</span>
            }
<span class="nc" id="L145">        }</span>
<span class="nc" id="L146">        ArrayList&lt;Case&gt; lib = g.getLiberte();</span>
<span class="nc" id="L147">        lib.remove(pos);</span>
<span class="nc" id="L148">        ArrayList&lt;Groupe&gt; grps = pos.getGroupesAdjacents();</span>
<span class="nc bnc" id="L149" title="All 6 branches missed.">        boolean b = grps.size()== 1 &amp;&amp; grps.get(0).getPierres().get(0).getJoueur() != j &amp;&amp; pos.nombreLibertesAutourDe() == 0 &amp;&amp; </span>
<span class="nc bnc" id="L150" title="All 2 branches missed.">                grps.get(0).getLiberte().size() == 1;</span>
        // b est vrai si la case est entièrement entourée par un seul groupe, si ce groupe appartient au joueur enemi,
        // et si ce groupe n'a qu'une liberté.
<span class="nc bnc" id="L153" title="All 4 branches missed.">        return lib.isEmpty() &amp;&amp; !b;</span>
    }
    
    public void incrPasse(){
<span class="nc" id="L157">        passe++;</span>
<span class="nc" id="L158">    }</span>
    
    public void resetPasse(){
<span class="nc" id="L161">        passe = 0;</span>
<span class="nc" id="L162">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span></div></body></html>